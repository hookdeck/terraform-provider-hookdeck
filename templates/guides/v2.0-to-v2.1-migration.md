---
page_title: "Migrating from v2.0 to v2.1"
description: "How to migrate from v2.0 to v2.1 of the Hookdeck Terraform Provider"
---

This release focuses on internal provider improvements with new features, bug fixes, and one minor breaking change that may require updating your configuration.

## Breaking Change

### Removed: `sdk_max_attempts` Provider Configuration

The `sdk_max_attempts` configuration option has been removed from the provider. Rate limiting is now automatically handled to respect Hookdeck API limits (240 requests/minute).

**Action Required**: Remove `sdk_max_attempts` from your provider configuration if present.

```hcl
# Before
provider "hookdeck" {
  api_key = "..."
  sdk_max_attempts = 5  # REMOVE THIS LINE
}

# After
provider "hookdeck" {
  api_key = "..."
}
```

## New Features

- **Deduplication Rules**: Connections now support [deduplication rules](https://hookdeck.com/docs/deduplication)
- **Transformation Hard Deletion**: Transformations are now permanently deleted instead of being renamed to `deleted-...`
- **Improved JSON Handling**: Filter rules now accept any valid JSON format without requiring specific encoding

## Improvements

- Automatic rate limiting to respect Hookdeck API limits (240 requests/minute)

## Troubleshooting

### Value Conversion Error with Connection Rules

If you encounter an error like this when upgrading:

```
Error: Value Conversion Error

An unexpected error was encountered trying to convert tftypes.Value into
connection.rule. This is always an error in the provider. Please report the
following to the provider developer:

mismatch between struct and object: Struct defines fields not found in
object: deduplicate_rule.
```

This error was fixed in a later provider release. To resolve it:

1. **Update to the latest provider version** in your Terraform configuration:
   ```hcl
   terraform {
     required_providers {
       hookdeck = {
         source  = "hookdeck/hookdeck"
         version = ">= 2.2.1"  # Or the latest version
       }
     }
   }
   ```

2. **Reinitialize Terraform** to download the updated provider:
   ```bash
   terraform init -upgrade
   ```

3. **Run plan/apply** - the state upgrade will happen automatically:
   ```bash
   terraform plan
   terraform apply
   ```

#### Workaround (if you cannot update the provider)

If you need an immediate workaround without updating the provider:

1. **Remove the affected resource from state**:
   ```bash
   terraform state rm hookdeck_connection.<your_connection_name>
   ```

2. **Import the resource with fresh state**:
   ```bash
   terraform import hookdeck_connection.<your_connection_name> <connection-id>
   ```
   
   You can find the connection ID in the Hookdeck dashboard or via the API.

3. **Verify with plan**:
   ```bash
   terraform plan
   ```

The changes in this release are mostly improvements with minimal impact on existing configurations.
